/*TMODJS:{"version":"1.0.0"}*/
function ajax(e,a,t,i,s,o){var n=mobile_url+"&controller="+a;t&&(n+="&action="+t),i||(i={});var r=["goods_detail"],d=e.toUpperCase();if("POST"==d||$.inArray(t,r)!=-1){var c=store.get("token");"object"==typeof c&&(i.key=c.key)}console.log(i),$.ajax({url:n,type:e,data:i,dataType:"json",success:function(e){console.log(e),$.hideIndicator(),"object"!=typeof e&&(e={code:404,datas:{error:"当前网络状况不佳,请稍后重试"}}),200==e.code?s(e):"请登录"==e.datas.error?$.router.load("#login"):($.toast(e.datas.error),"function"==typeof o&&o())},error:function(e,a){$.hideIndicator(),$.alert("请检测网络连接!")}})}function isEmpty(e){return!e||0===Object.keys(e).length}function checkData(e){return"null"==e||null==e?"":e}function renderHtml(e,a,t,i){var s=template(a,t);i?e.append(s):e.html(s)}function redirect(e,a){if("object"==typeof e)var a=$(e).data("param"),e=$(e).data("type");switch(e){case"good":_goods(a);break;case"goods":__goodslist(a)}}function checkMobile(e){var a=/^(((13[0-9]{1})|(15[0-9]{1})|(18[0-9]{1}))+\d{8})$/,t=a.test(e);return e?!!t||($.alert("请输入正确的手机号"),!1):($.alert("请输入手机号"),!1)}!function(){function e(e,a){return(/string|function/.test(typeof a)?r:n)(e,a)}function a(e,t){return"string"!=typeof e&&(t=typeof e,"number"===t?e+="":e="function"===t?a(e.call(e)):""),e}function t(e){return v[e]}function i(e){return a(e).replace(/&(?![\w#]+;)|[<>"']/g,t)}function s(e,a){if(u(e))for(var t=0,i=e.length;t<i;t++)a.call(e,e[t],t,e);else for(t in e)a.call(e,e[t],t)}function o(e,a){var t=/(\/)[^\/]+\1\.\.\1/,i=("./"+e).replace(/[^\/]+$/,""),s=i+a;for(s=s.replace(/\/\.\//g,"/");s.match(t);)s=s.replace(t,"/");return s}function n(a,t){var i=e.get(a)||d({filename:a,name:"Render Error",message:"Template not found"});return t?i(t):i}function r(e,a){if("string"==typeof a){var t=a;a=function(){return new l(t)}}var i=c[e]=function(t){try{return new a(t,e)+""}catch(i){return d(i)()}};return i.prototype=a.prototype=f,i.toString=function(){return a+""},i}function d(e){var a="{Template Error}",t=e.stack||"";if(t)t=t.split("\n").slice(0,2).join("\n");else for(var i in e)t+="<"+i+">\n"+e[i]+"\n\n";return function(){return"object"==typeof console&&console.error(a+"\n\n"+t),a}}var c=e.cache={},l=this.String,v={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},u=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)},f=e.utils={$helpers:{},$include:function(e,a,t){return e=o(t,e),n(e,a)},$string:a,$escape:i,$each:s},p=e.helpers=f.$helpers;e.get=function(e){return c[e.replace(/^\.\//,"")]},e.helper=function(e,a){p[e]=a},"function"==typeof define?define(function(){return e}):"undefined"!=typeof exports?module.exports=e:this.template=e,e("addr-edit",function(e,a){"use strict";var t=this,i=(t.$helpers,t.$escape),s=e.address_info,o="";return o+='<input type="hidden" name="address_id" id="address-id" value="',o+=i(s.address_id),o+='"/> <input type="hidden" name="pr_id" id="area1" value="',o+=i(s.pr_id),o+='"/> <input type="hidden" name="city_id" id="area2" value="',o+=i(s.city_id),o+='"/> <input type="hidden" name="area_id" id="area3" value="',o+=i(s.area_id),o+='"/> <li> <a href="#" class="item-link item-content open-popup" data-popup=".popup-area"> <div class="item-inner"> <div class="item-title">地区选择</div> <div class="item-after" id="area-info">',o+=i(s.area_info),o+='</div> </div> </a> </li> <li> <div class="item-content"> <div class="item-inner"> <div class="item-title label">详细地址</div> <div class="item-input"> <input type="text" placeholder="请输入详细地址" id="addr-detail" value="',o+=i(s.address),o+='"> </div> </div> </div> </li> <li> <div class="item-content"> <div class="item-inner"> <div class="item-title label">收 件 人</div> <div class="item-input"> <input type="text" placeholder="请输入收货人姓名" id="true-name" value="',o+=i(s.true_name),o+='"> </div> </div> </div> </li> <li> <div class="item-content"> <div class="item-inner"> <div class="item-title label">手 机 号</div> <div class="item-input"> <input type="text" placeholder="请输入收货人手机号" id="mob-phone" value="',o+=i(s.mob_phone),o+='"> </div> </div> </div> </li> <li> <div class="item-content"> <div class="item-inner"> <div class="item-title label">身份证号码</div> <div class="item-input"> <input type="text" placeholder="购保税仓商品必填" id="idcard_no" value="',o+=i(s.idcard_no),o+='"> </div> </div> </div> </li>',new l(o)}),e("address",function(e,a){"use strict";var t=this,i=(t.$helpers,t.$escape),s=e.address_count,o=t.$each,n=e.address_list,r=(e.value,e.i,"");return r+='<div class="content-padded">已有<span class="button-danger" id="address-count">',r+=i(s),r+="</span>条收货地址（最多添加10条）</div> ",o(n,function(e,a){r+=' <div class="card" data-address-id="',r+=i(e.address_id),r+='"> <div class="card-content"> <div class="card-content-inner address-item"> <p>',r+=i(e.true_name),r+=" ",r+=i(e.mob_phone),r+="</p> <p>",r+=i(e.area_info),r+=" ",r+=i(e.address),r+="</p> ",e.idcard_no&&(r+="<p>身份证号:",r+=i(e.idcard_no),r+="</p>"),r+=' </div> </div> <div class="card-footer"> <div class="op-btn"> <a class="edit" href=""><i class="icon iconfont icon-edit"></i>编辑</a> <a class="del" href=""><i class="icon iconfont icon-delete"></i>删除</a> <a class="default" href=""><i class="icon iconfont ',r+=1==e.is_default?"icon-roundcheckfill":"icon-roundcheck",r+='"></i>设为默认</a> </div> </div> </div> '}),r+=' <div class="content-padded"> <a class="button button-fill button-warning" id="add-address">添加收货地址</a> </div>',new l(r)}),e("area",function(e,a){"use strict";var t=this,i=(t.$helpers,t.$each),s=e.area_list,o=(e.value,e.i,t.$escape),n="";return i(s,function(e,a){n+=' <li class="item-content ',3!=e.area_deep&&(n+="item-link"),n+='" data-area-id="',n+=o(e.area_id),n+='" data-area-deep="',n+=o(e.area_deep),n+='" data-area-name="',n+=o(e.area_name),n+='"> <div class="item-inner"> <div class="item-title">',n+=o(e.area_name),n+="</div> </div> </li> "}),new l(n)}),e("buy",function(e,a){"use strict";var t=this,i=(t.$helpers,t.$escape),s=e.deliveryText,o=e.selected_address_info,n=e.error_message,r=t.$each,d=e.store_cart_list,c=(e.value,e.i,e.store_cart_total),v=e.freight_total,u="";return u+='<div class="list-block mb10"> <a href="" class="item-link item-content" id="delivery"> <div class="item-inner"> <div class="item-title">配送方式</div> <div class="item-after" id="delivery-text">',u+=i(s),u+="</div> </div> </a> </div> ",o?(u+=' <div class="list-block media-list"> <ul> <li> <a href="#address" data-no-history="true" class="item-link item-content"> <div class="item-inner"> <div class="item-title-row"> <div class="item-title">',u+=i(o.true_name),u+="-",u+=i(o.mob_phone),u+='</div> </div> <div class="item-subtitle">',u+=i(o.area_info),u+='</div> <div class="item-text">',u+=i(o.address),u+="</div> </div> </a> </li> </ul> </div> "):u+=' <div class="content-block"> <a href="#address" class="button button-fill button-danger">添加收货地址</a> </div> ',u+=" ",n&&(u+=' <div class="list-block"> <li class="item-content f14 color-danger">提示信息:',u+=i(n),u+="</li> </div> "),u+=' <div class="list-block media-list mt10"> <ul class="list-container goods-list"> ',r(d,function(e,a){u+=' <li> <a href="" data-good_id="',u+=i(e.goods_id),u+='" class="item-content jGo"> <div class="item-media"> <img src="',u+=i(e.goods_image_url),u+='"> </div> <div class="item-inner"> <div class="item-title-row"> <div class="item-title f14">',u+=i(e.goods_name),u+='</div> </div> <div class="item-subtitle"> <span class="present color-danger f13 mr10">¥',u+=i(e.goods_price),u+='</span> <span class="original f10 color-gray"><del>¥',u+=i(e.goods_marketprice),u+='</del></span> </div> <div class="item-text">',e.is_chain&&(u+="支持自提"),u+=' <span class="badge pull-right">x',u+=i(e.goods_num),u+="</span> </div> </div> </a> </li> "}),u+=' </ul> </div> <div class="list-block"> <ul> <li class="item-content"> <div class="item-inner"> <div class="item-title">商品总计</div> <div class="item-after">¥',u+=i(c),u+='</div> </div> </li> <li class="item-content"> <div class="item-inner"> <div class="item-title">运费总计</div> <div class="item-after">¥',u+=i(v),u+="</div> </div> </li> </ul> </div>",new l(u)}),e("cart",function(e,a){"use strict";var t=this,i=(t.$helpers,e.cart_num),s=t.$each,o=e.cart_list,n=(e.value,e.i,t.$escape),r="";return i?(r+=" ",s(o,function(e,a){r+=' <li class="item-content"> <div class="item-media radio" data-cart_id="',r+=n(e.cart_id),r+='" data-checked="',r+=n(e.cart_checked),r+='"> <i class="icon iconfont ',r+=1==e.cart_checked?"icon-roundcheckfill":"icon-roundcheck",r+='"></i> </div> <div class="item-media"> <a href="" data-good_id="',r+=n(e.goods_id),r+='" class="jGo"> <img src="',r+=n(e.goods_image),r+='"> </a> </div> <div class="item-inner"> <div class="item-title-row"> <div class="item-title f12"> <a href="" data-good_id="',r+=n(e.goods_id),r+='" class="jGo">',r+=n(e.goods_name),r+='</a> </div> </div> <div class="item-subtitle"> <div class="add-box jQty"> <a class="box-zone-l ',r+=e.goods_num>1?"jQtyMin":"jDel",r+='" data-num="',r+=n(e.goods_num),r+='" data-cart_id="',r+=n(e.cart_id),r+='"> <div class="box-l box-del"> <i class="icon iconfont ',r+=e.goods_num>1?"icon-move":"icon-delete",r+='"></i> </div> </a> <div class="box-zone-m"> <div class="box-m jQtyTxt">',r+=n(e.goods_num),r+='</div> </div> <a class="box-zone-r jQtyAdd" data-num="',r+=n(e.goods_num),r+='" data-cart_id="',r+=n(e.cart_id),r+='"> <div class="box-r"> <i class="icon iconfont icon-add"></i> </div> </a> </div> </div> <div class="item-text"> <span class="present color-danger f13 mr10">¥',r+=n(e.good_final_price),r+='</span> <span class="original f10 color-gray"><del>¥',r+=n(e.goods_marketprice),r+="</del></span> </div> </div> </li> "}),r+=" "):r+=' <div class="empty"> <p class="emt-img"></p> <p class="emt-txt">购物车快饿瘪了T.T</p> <p class="emt-txt-tag">主人快给我挑点宝贝吧</p> <a href="#home" class="button button-small" >去逛逛</a> </div> ',new l(r)}),e("catlog",function(e,a){"use strict";var t=this,i=(t.$helpers,t.$each),s=e.class_list,o=(e.value,e.i,t.$escape),n=(e.cValue,"");return i(s,function(e,a){n+=' <dl> <dt><a href="" data-gcid="',n+=o(e.gc_id),n+='">',n+=o(e.gc_name),n+="</a></dt> ",i(e.child,function(e,a){n+=' <dd><a href="" data-gcid="',n+=o(e.gc_id),n+='">',n+=o(e.gc_name),n+="</a> </dd> "}),n+=" </dl> "}),new l(n)}),e("comment",function(e,a){"use strict";var t=this,i=(t.$helpers,e.goods_eval_list),s=t.$each,o=(e.value,e.i,t.$escape),n="";return n+='<div class="list-block media-list"> ',0==i.length?n+=' <div class="empty"> <p class="icon iconfont icon-form f14"></p> <p class="emt-txt">暂无评论</p> </div> ':(n+=" <ul> ",s(i,function(e,a){n+=' <li> <div class="item-content"> <div class="item-media"><img src="',n+=o(e.member_avatar),n+='"></div> <div class="item-inner"> <div class="item-title-row"> <div class="item-title">',n+=o(e.geval_frommembername),n+='</div> <div class="item-after">',n+=o(e.add_time),n+='</div> </div> <div class="item-subtitle">',n+=o(e.geval_content),n+="</div> </div> </div> </li> "}),n+=" </ul> "),n+=" </div>",new l(n)}),e("deliver",function(e,a){"use strict";var t=this,i=(t.$helpers,t.$escape),s=e.express_name,o=e.shipping_code,n=t.$each,r=e.deliver_info,d=(e.value,e.i,"");return d+="<div>物流公司:",d+=i(s),d+="</div> <div>物流单号:",d+=i(o),d+="</div> ",n(r,function(e,a){d+=" <div>",d+=i(e),d+="</div> "}),new l(d)}),e("favorite",function(e,a){"use strict";var t=this,i=(t.$helpers,e.favorites_list),s=t.$each,o=(e.value,e.i,t.$escape),n="";return i?(n+=" ",s(i,function(e,a){n+=' <li> <a href="" data-good_id="',n+=o(e.goods_id),n+='" class="item-content jGo"> <div class="item-media"> <img class="b-lazy" data-src="',n+=o(e.goods_image_url),n+='" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></div> <div class="item-inner"> <div class="item-title-row"> <div class="item-title f12">',n+=o(e.goods_name),n+='</div> </div> <div class="item-text"> <span class="present color-danger f13 mr10">¥',n+=o(e.goods_price),n+="</span> </div> </div> </a> </li> "}),n+=" "):n+=' <div class="empty"> <p class="icon iconfont icon-form f14"></p> <p class="emt-txt">暂无评论</p> </div> ',new l(n)}),e("good-basic",function(e,a){"use strict";var t=this,i=(t.$helpers,t.$each),s=e.slide,o=(e.value,e.i,t.$escape),n=e.goods_info,r=e.is_favorate,d=e.freight_title,c=e.freight_to,v=e.freight_text,u=(e.specValue,e.x,e.spec_list),f="";return f+='<div class="swiper-container" id="slide" data-space-between=\'10\'> <div class="swiper-wrapper"> ',i(s,function(e,a){f+=' <div class="swiper-slide"> <img src="',f+=o(e),f+='" alt=""> </div> '}),f+=' </div> <div class="swiper-pagination"></div> </div> <div class="item-prices"> <span class="item-price show-price-tag" data-text="促销价">',f+=o(n.goods_price),f+='</span> <span class="item-price-origin">',f+=o(n.goods_marketprice),f+='</span> <span class="pull-right"> <i id="favorate" class="icon iconfont icon-like ',f+=o(r?"active":""),f+='"></i> </span> </div> <div class="item-info"> <div class="item-title">',f+=o(n.goods_name),f+='</div> <div class="item-desc"> ',f+=o(n.goods_jingle),f+=' </div> </div> <div class="freight-info" id="freight-info"> <p>配送:',f+=o(d),f+="</p> <p>送至:",f+=o(c),f+=",运费",f+=o(v),f+="</p> </div> ",n.spec_name&&(f+=' <div class="good-spec"> ',i(n.spec_name,function(e,a){f+=' <div class="content-block-title">',f+=o(e),f+='</div> <div class="spec-item goods-list"> ',i(n.spec_value[a],function(e,a){f+=' <a href="" data-good_id="',f+=o(u[a]),f+='" class="',n.goods_spec[a]&&(f+="active"),f+='">',f+=o(e),f+="</a> "}),f+=" </div> "}),f+=" </div> "),new l(f)}),e("goods",function(e,a){"use strict";var t=this,i=(t.$helpers,t.$each),s=e.goods_list,o=(e.value,e.i,t.$escape),n="";return i(s,function(e,a){n+=' <li> <a href="" data-good_id="',n+=o(e.goods_id),n+='" class="item-content jGo"> <div class="item-media"> <img class="b-lazy" data-src="',n+=o(e.goods_image_url),n+='" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></div> <div class="item-inner"> <div class="item-title-row"> <div class="item-title f12">',n+=o(e.goods_name),n+='</div> </div> <div class="item-subtitle">',n+=o(e.goods_jingle),n+='</div> <div class="item-text"> <span class="present color-danger f13 mr10">¥',n+=o(e.goods_price),n+='</span> <span class="original f10 color-gray"><del>¥',n+=o(e.goods_marketprice),n+="</del></span> </div> </div> </a> </li> "}),new l(n)}),e("my-order",function(e,a){"use strict";var t=this,i=(t.$helpers,e.order_list),s=t.$each,o=(e.value,e.i,t.$escape),n=(e.good,e.j,e.hasmore),r="";return 0==i.length?r+=' <div class="empty"> <p class="icon iconfont icon-form f14"></p> <p class="emt-txt">暂无订单</p> </div> ':(r+=" ",s(i,function(e,a){r+=' <div class="card"> <div class="card-header">订单号:',r+=o(e.order_sn),r+='<span class="pull-right">',r+=o(e.add_time),r+='</span></div> <div class="card-content" data-order_id="',r+=o(e.order_id),r+='"> <div class="list-block media-list"> <ul> ',s(e.extend_order_goods,function(e,a){r+=' <li class="item-content"> <div class="item-media"> <img src="',r+=o(e.goods_image),r+='"> </div> <div class="item-inner"> <div class="item-title-row"> <div class="item-title">',r+=o(e.goods_name),r+='</div> </div> <div class="item-subtitle color-danger">¥',r+=o(e.goods_price),r+='</div> <div class="item-text pull-right"> <span class="badge">x',r+=o(e.goods_num),r+="</span> </div> </div> </li> "}),r+=' </ul> </div> </div> <div class="card-footer"> 实付款: ¥',r+=o(e.order_amount),r+=' <span class="pull-right" data-order_id="',r+=o(e.order_id),r+='" data-order_sn="',r+=o(e.order_sn),r+='"> ',e.if_cancel&&(r+='<a href="#" class="button button-danger jOrderOp" data-optype="order_cancel">取消订单</a>'),r+=" ",e.if_cancel&&(r+='<a href="#pay" class="button button-fill button-danger jGoPay" data-pay_sn="',r+=o(e.pay_sn),r+='" data-order_total="',r+=o(e.order_amount),r+='">去支付</a>'),r+=" ",e.if_delete&&(r+='<a href="#" class="button button-danger jOrderOp" data-optype="order_del">删除订单</a>'),r+=" ",e.if_deliver&&(r+='<a href="#" class="button button-danger jSearchDeliver">查看物流</a>'),r+=" ",e.if_receive&&(r+='<a href="#" class="button button-danger jOrderOp" data-optype="order_receive">确认收货</a>'),r+=" <!--",e.if_evaluation&&(r+='<a href="" class="button button-danger jEvaluate">评论</a>'),r+="--> </span> </div> </div> "}),r+=" ",n&&(r+=' <div class="infinite-scroll-preloader"> <div class="preloader"></div> </div> '),r+=" "),new l(r)}),e("my_comments",function(e,a){"use strict";var t=this,i=(t.$helpers,e.goodsevallist),s=t.$each,o=(e.value,e.i,t.$escape),n="";return i?(n+=" ",s(i,function(e,a){n+=' <li> <a href="" data-good_id="',n+=o(e.geval_goodsid),n+='" class="item-content jGo"> <div class="item-media"> <img class="b-lazy" data-src="',n+=o(e.goods_image_url),n+='" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></div> <div class="item-inner"> <div class="item-title-row"> <div class="item-title f12">',n+=o(e.geval_goodsname),n+='</div> </div> <div class="item-subtitle starts-',n+=o(e.geval_scores),n+='"> <span class="icon iconfont icon-start lv-1"></span> <span class="icon iconfont icon-start lv-2"></span> <span class="icon iconfont icon-start lv-3"></span> <span class="icon iconfont icon-start lv-4"></span> <span class="icon iconfont icon-start lv-5"></span> </div> <div class="item-text"> <span class="present f13 mr10">',n+=o(e.geval_content),n+="</span> </div> </div> </a> </li> "}),n+=" "):n+=' <div class="empty"> <p class="icon iconfont icon-form f14"></p> <p class="emt-txt">暂无商品评论</p> </div> ',new l(n)}),e("order_detail",function(e,a){"use strict";var t=this,i=(t.$helpers,t.$escape),s=e.order_sn,o=e.add_time,n=e.state_desc,r=e.order_id,d=e.if_buyer_cancel,c=e.pay_sn,v=e.order_amount,u=e.if_delete,f=e.if_receive,p=e.if_evaluation,m=e.extend_order_common,_=e.chain_info,g=e.if_deliver,h=e.chain_code,$=t.$each,b=e.extend_order_goods,k=(e.value,e.i,e.goods_amount),y=e.shipping_fee,x="";return x+='<div class="card"> <div class="card-header"> 订单号:',x+=i(s),x+=' <span class="pull-right">',x+=i(o),x+='</span></div> <div class="card-content"> <div class="card-content-inner"> ',x+=i(n),x+=' <span class="pull-right" data-order_id="',x+=i(r),x+='" data-order_sn="',x+=i(s),x+='"> ',d&&(x+='<a href="#" class="button button-danger jOrderOp" data-optype="order_cancel">取消订单</a>'),x+=" ",d&&(x+='<a href="#pay" class="button button-fill button-danger jGoPay" data-pay_sn="',x+=i(c),x+='" data-order_total="',x+=i(v),x+='">去支付</a>'),x+=" ",u&&(x+='<a href="" class="button button-danger jOrderOp" data-optype="order_del">删除订单</a>'),x+=" ",f&&(x+='<a href="" class="button button-danger jOrderOp" data-optype="order_receive">确认收货</a>'),x+=" ",p&&(x+='<a href="" class="button button-danger jEvaluate">评论</a>'),x+=' </span> </div> </div> </div> <div class="list-block media-list"> <div class="item-content"> <div class="item-media"> ',m&&(x+="收货地址:"),x+=" ",_&&(x+="门店信息:"),x+=' </div> <div class="item-inner"> ',m.reciver_info&&(x+=' <div class="item-title">',x+=i(m.reciver_name),x+=" ",x+=i(m.reciver_info.mob_phone),x+='</div> <div class="item-subtitle">',x+=i(m.reciver_info.address),x+="</div> "),x+=" ",_&&(x+=' <div class="item-title">',x+=i(_.chain_name),x+=' </div> <div class="item-subtitle"> <p>',x+=i(_.area_info),x+=" ",x+=i(_.chain_address),x+="</p> <p>营业时间:",x+=i(_.chain_opening_hours),x+="</p> <p>电话:",x+=i(_.chain_phone),x+="</p> </div> "),x+=' </div> </div> <div class="item-content"> <div class="item-media"> 配送方式: </div> <div class="item-inner"> <div class="item-title-row"> <div class="item-title">',x+=_?"自提":"普通快递",x+="</div> ",g&&(x+=' <div class="item-after" data-order_sn="',x+=i(s),x+='"> <a href="" class="button button-small jSearchDeliver">查看物流</a> </div> '),x+=" ",0!=h&&(x+=' <div class="item-after">提货码:',x+=i(h),x+="</div> "),x+=' </div> </div> </div> </div> <div class="card"> <div class="card-content"> <div class="list-block media-list"> <ul> ',$(b,function(e,a){x+=' <li class="item-content"> <div class="item-media"> <img src="',x+=i(e.image_url),x+='" alt=""> </div> <div class="item-inner"> <div class="item-title-row"> <div class="item-title">',x+=i(e.goods_name),x+='</div> </div> <div class="item-subtitle color-danger">',x+=i(e.goods_price),x+='</div> <div class="item-text pull-right"> <span class="badge">',x+=i(e.goods_num),x+="</span> </div> </div> </li> "}),x+=' </ul> </div> </div> <div class="card-footer"> 数量:',x+=i(b.length),x+=' <span class="pull-right"> 合计:¥',x+=i(k),x+=' </span> </div> </div> <div class="list-block"> <ul> <li class="item-content"> <div class="item-inner"> <div class="item-title">商品金额</div> <div class="item-after">¥',x+=i(k),x+='</div> </div> </li> <li class="item-content"> <div class="item-inner"> <div class="item-title">配送费用</div> <div class="item-after">¥',x+=i(y),x+='</div> </div> </li> <li class="item-content"> <div class="item-inner"> <div class="item-title">订单金额</div> <div class="item-after">¥',x+=i(v),x+="</div> </div> </li> </ul> </div>",new l(x)}),e("order_evaluate",function(e,a){"use strict";var t=this,i=(t.$helpers,t.$each),s=e.extend_order_goods,o=(e.value,e.i,t.$escape),n=e.order_id,r="";return r+=' <div class="list-block media-list"> <ul> ',i(s,function(e,a){r+=' <li class="item-content"> <div class="item-media"> <img src="',r+=o(e.image_url),r+='"> </div> <div class="item-inner" data-rec_id="',r+=o(e.rec_id),r+='"> <div class="item-title-row"> <div class="item-title starts-5" data-start="5"> <span class="icon iconfont icon-start lv-1" data-start="1"></span> <span class="icon iconfont icon-start lv-2" data-start="2"></span> <span class="icon iconfont icon-start lv-3" data-start="3"></span> <span class="icon iconfont icon-start lv-4" data-start="4"></span> <span class="icon iconfont icon-start lv-5" data-start="5"></span> </div> <div class="item-after"> 匿名:<span class="icon iconfont icon-roundcheck jAnony"></span> </div> </div> <div class="item-subtitle"> <textarea></textarea> </div> </div> </li> '}),r+=' </ul> </div> <div class="content-block"> <a href="" class="button button-fill button-danger" id="evaluate_btn" data-order_id="',r+=o(n),r+='">提交评价</a> </div> ',new l(r)}),e("xianshi",function(e,a){"use strict";var t=this,i=(t.$helpers,t.$each),s=e.xianshi,o=(e.value,e.i,t.$escape),n=(e.item,e.k,"");return i(s,function(e,a){n+=' <div class="content-block-title">',n+=o(e.title),n+='<span class="pull-right countdown" data-endtime="',n+=o(e.endtime),n+='"></span></div> <div class="list-block media-list"> <ul class="list-container goods-list"> ',i(e.goods,function(e,a){n+=' <li> <a href="" data-good_id="',n+=o(e.goods_id),n+='" class="item-content jGo"> <div class="item-media"> <img class="b-lazy" data-src="',n+=o(e.goods_image_url),n+='" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></div> <div class="item-inner"> <div class="item-title-row"> <div class="item-title f12">',n+=o(e.goods_name),n+='</div> </div> <!--<div class="item-subtitle">',n+=o(e.xianshi_discount),n+='</div>--> <div class="item-text"> <span class="present color-danger f13 mr10">¥',n+=o(e.xianshi_price),n+='</span> <span class="original f10 color-gray"><del>¥',n+=o(e.goods_price),n+="</del></span> </div> </div> </a> </li> "}),n+=" </ul> </div> "}),new l(n)})}();var mobile_url="http://api.htths.com/index.php?XDEBUG_SESSION_START=PHPSTORM",session={set:function(e,a){"string"!=typeof a?sessionStorage.setItem(e,JSON.stringify(a)):sessionStorage.setItem(e,a)},get:function(e){var a=sessionStorage.getItem(e);return a&&(a=JSON.parse(a)),a}};$(function(){"use strict";var e=new Blazy,a=store.get("cartnum");a>0&&$(".cart-num").text(a),$(document).on("click","a.jGo",function(){var e=$(this),a=e.data("type");if(a){var t=e.data("parm"),i=store.get("goodsParm");switch(a){case"catlog":i.gc_id=t,i.keyword="";break;case"keyword":i.gc_id="",i.keyword=t}store.set("goodsParm",i)}else session.set("good_id",$(this).data("good_id")),$.router.load("#item","true")}),$(document).on("pageInit","#home",function(a,t,i){function s(e,a){var t=store.get(e),i=$("#"+e);t?renderHtml(i,"goods",t):ajax("GET","goods","goods_list206",a,function(a){var t=a.datas;store.set(e,t,64800),renderHtml(i,"goods",t)})}ajax("GET","index","xianshi2","",function(e){renderHtml($("#xianshi"),"xianshi",e.datas),$(".countdown").each(function(){var e=111;new Countdown(this,{format:"hh小时mm分ss秒",lastTime:e})})}),$(i).find(".content").on("scroll",function(){e.revalidate()}),s("hot_list","{page:5,key:1,curpage:1}"),s("recommend_list","{page:6,key:2,curpage:1}");var o=1,n=!0;$(i).on("infinite",function(){function e(e){ajax("get","goods","goods_list206",{page:8,key:4,curpage:e},function(e){renderHtml($("#new-list"),"goods",e.datas,!0),$.refreshScroller(),e.hasmore&&(n=!0)},function(){o--,n=!0})}return!!n&&(n=!1,o++,void e(o))})}),$(document).on("pageInit","#catlog",function(e,a,t){function i(e){var a="",t="";for(var i in e)a+='<li class="',1==i&&(a+="active",t=e[i].gc_id),a+='" data-id="'+e[i].gc_id+'">'+e[i].gc_name+"</li>";$(".title-list").html(a),s(t)}function s(e){var a={gc_id:e},t=store.get("goods_class"+e);return"undefined"!=typeof t?(o(t),!1):void ajax("get","goods_class","",a,function(a){var t=a.datas;store.set("goods_class"+e,t),o(t)})}function o(e){var a=template("catlog",e);$(".type-list").html(a)}var n=!1;if($(".title-list li").each(function(){$(this).hasClass("active")&&(n=!0)}),!n){var r=store.get("top_class");r?i(r):ajax("get","goods_class","index2","",function(e){store.set("top_class",e.datas.class_list),i(e.datas.class_list)})}var d=$(".title-list");$(d).on("click","li",function(){if($(this).hasClass("active"))return!1;$(d).find("li").removeClass("active"),$(this).addClass("active");var e=$(this).attr("data-id");s(e)});var c=store.get("goodsParm");"undefined"==typeof c&&(c={curpage:1,page:8,key:4,order:1},store.set("goodsParm",c)),$(".type-list").off("click","a").on("click","a",function(){c.gc_id=$(this).attr("data-gcid"),c.keyword="",store.set("goodsParm",c),$.router.load("#goods")}),$("input").off("keypress").keypress(function(e){13==e.which&&(c.gc_id="",c.keyword=$("#search").val(),store.set("goodsParm",c),document.activeElement.blur(),$.router.load("#goods"))})}),$(document).on("pageInit","#goods",function(a,t,i){$(i).find(".content").on("scroll",function(){e.revalidate()});var s=function(a,t){t&&(a.curpage=1,$(".goods-list").empty()),ajax("get","goods","goods_list206",a,function(a){n.curpage=o.curpage,a.hasmore||(n.hasMore=!1,$(i).find(".more").html("")),t&&a.hasmore&&$(i).find(".more").html('<div class="infinite-scroll-preloader"><div class="preloader"></div></div>'),renderHtml($("#good_list"),"goods",a.datas,!0),t&&e.revalidate(),$.refreshScroller(),d=!0},function(){d=!0,o.curpage=n.curpage})},o=store.get("goodsParm"),n={hasMore:!0,curpage:1};s(o,!0);var r=$("#buttons_tab"),d=!0;r.off("click","a").on("click","a",function(){d=!1;var e=$(this),a=e.data("key");if(e.hasClass("active")&&3!=a)return!1;if(e.siblings().removeClass("active"),e.addClass("active"),3==a){var t=e.data("order"),i=t-1>0?"1":"2";e.attr("data-order",i)}o.key=a,o.order=i,store.set("goodsParm",o),s(o,!0)}),$(i).off("infinite").on("infinite",function(){return!(n.curpage!=o.curpage||!n.hasMore||!d)&&(o.curpage=n.curpage+1,void s(o))});var c=$(i).find(".content").on("refresh",function(e){s(o,!0),$.pullToRefreshDone(c)})}),$(document).on("pageInit","#item",function(e,a,t){function i(e,a){var t=$("#good-basic");t.html(""),ajax("get","goods","goods_detail",e,function(a){var i=a.datas;i.slide=i.goods_image.split(",");var s=template("good-basic",i);t.html(s),$("#slide").swiper({pagination:"#slide > .swiper-pagination"});var o=$("#favorate");o.off("click").click(function(){var a=$(this),t=a.hasClass("active")?"favorites_del":"favorites_add";ajax("post","member_favorites",t,e,function(e){"favorites_add"==t?o.addClass("active"):o.removeClass("active")})})})}function s(e){var t={goods_id:e,number:4};ajax("get","goods","goods_rand_list",t,function(e){var t=e.datas,i="";for(a in t)i+='<li>               <a href="" class="jGo" data-good_id="'+t[a].goods_id+'">                 <img src="'+t[a].goods_image_url+'" alt="">                 <h5>'+t[a].goods_name+"</h5>               </a>             </li>";c.find("ul").html(i)})}function o(e,a,t){void 0==a&&(a=1),ajax("post","member_cart","cart_add",{goods_id:e,quantity:a},function(e){var a=e.datas.cart_count;store.set("cartnum",a),t(a)})}$(t).on("click","a.back",function(){var e=$(".jBasic");$.showTab(e.data("tab")||e.attr("href"),e)}),$("#kefu").off("click").click(_MEIQIA("showPanel"));var n=session.get("good_id"),r={goods_id:n};i(r,!0),s(n);var d=$(t).find(".content").on("refresh",function(e){console.log(5),r.curpage=1,i(r,!0),$.pullToRefreshDone(d)}),c=$("#ulike"),l=$("#good-basic");l.off("click","a").on("click","a",function(){var e=$(this).data("good_id");session.set("good_id",e),r.goods_id=e,i(r,!0)}),$("#buy_now").off("click").click(function(){var e=sessionStorage.getItem("good_id"),a={cart_id:e+"|1",ifcart:0};session.set("cartParm",a),$.router.load("#buy")}),$("#add_cart").off("click").click(function(){o(n,1,function(e){$(".cart-num").text(e),$.toast("添加购物车成功")})});var v=$("#picture");$(".jPicture").off("click").click(function(){v.html(""),ajax("get","goods","goods_body",{goods_id:n},function(e){v.html(e.datas)})});var u=$("#good_comment"),f=!1;$(".jComment").off("click").click(function(){u.html(""),ajax("get","goods","goods_evaluate",{goods_id:n,type:1},function(e){f=e.hasmore,renderHtml(u,"comment",e.datas)})});var p=2,m=!0;$(t).on("infinite",function(){return!!m&&(m=!1,void("good_comment"==$(this).find(".infinite-scroll.active").attr("id")&&f&&ajax("get","goods","goods_evaluate",{goods_id:n,type:1,curpage:p},function(e){m=e.hasmore,m&&p++,renderHtml(u,"comment",e.datas,!0)})))})}),$(document).on("pageInit","#cart",function(e,a,t){function i(e,a){var t={cart_id:e,quantity:a};ajax("post","member_cart","cart_edit_quantity",t,function(e){var a=e.datas;o(a)})}function s(e,a){var t={cart_id:e,cart_checked:a};ajax("post","member_cart","cart_checked",t,function(e){o(e.datas)})}function o(e){renderHtml(n,"cart",e),store.set("cartnum",e.cart_num),$(".cart-num").text(e.cart_num);var a=$("#cart-all-checked");$("#need2pay").text(e.need2pay),a.data("cart_id",e.cart_all_item),e.cart_all_checked?(a.removeClass("icon-roundcheck"),a.addClass("icon-roundcheckfill"),a.parent().addClass("active")):(a.removeClass("icon-roundcheckfill"),a.addClass("icon-roundcheck"),a.parent().removeClass("active"));var t=$("#jStep1");if(e.allow_submit){var i={cart_id:e.cart_checked_item,ifcart:1};session.set("cartParm",i),t.off("click").click(function(){$.router.load("#buy")})}else t.removeClass("red-color"),t.addClass("disable")}var n=$("#cart_list");ajax("post","member_cart","cart_list","",function(e){var a=e.datas;console.log(a),o(a)}),n.off("click",".jQtyAdd").on("click",".jQtyAdd",function(){var e=$(this),a=e.attr("data-num")-0+1,t=e.data("cart_id");i(t,a)}),n.off("click",".jQtyMin").on("click",".jQtyMin",function(){var e=$(this),a=e.attr("data-num")-0-1,t=e.data("cart_id");i(t,a)}),n.off("click",".jDel").on("click",".jDel",function(){var e=$(this),a=e.data("cart_id");$.confirm("确定要删除?",function(){ajax("post","member_cart","cart_del",{cart_id:a},function(e){o(e.datas)})},function(){return!1})}),n.off("click",".radio").on("click",".radio",function(){var e=$(this),a=e.data("cart_id"),t=1==e.attr("data-checked")?0:1;s(a,t)}),$("#cart-all-checked").off("click").click(function(){var e=$(this),a=e.data("cart_id"),t=e.hasClass("icon-roundcheck")?1:0;s(a,t)})}),$(document).on("pageInit","#buy",function(e,a,t){var i=session.get("cartParm");console.log(i);var s=$("#step2");ajax("post","member_buy","buy_step1",i,function(e){var a=e.datas;i.address_id=a.selected_address_id,session.set("cartParm",i),a.deliveryText=1==i.ifchain?"上门自提":"快递",renderHtml($("#buy_wrapper"),"buy",a),$("#total-pay").text("¥"+a.need2pay),a.allow_submit?s.removeClass("button-gray"):s.addClass("button-gray")}),s.off("click").click(function(){if($(this).hasClass("button-gray"))return!1;var e=session.get("cartParm");ajax("post","member_buy","buy_step2",e,function(e){session.set("orderPay",e.datas),
$.router.load("#pay")})}),$(t).off("click","#delivery").on("click","#delivery",function(){var e=[{text:"请选择",label:!0},{text:"快递",bold:!0,color:"danger",onClick:function(){$.router.load("#address","true","true"),$.closeModal()}},{text:"自提",onClick:function(){$.router.load("#chain","true","true"),$.closeModal()}}];$.actions(e)})}),$(document).on("pageInit","#pay",function(e,a,t){var i=session.get("orderPay");$("#order-pay").text("¥"+i.order_total);var s=store.get("token").key;$("#pay-now").off("click").click(function(){var e=$("input[name=pay]:checked").val();return e?(console.log(e),void(location.href="http://api.htths.com/index.php?controller=member_payment&action=pay_new&payment_code="+e+"&pay_sn="+i.pay_sn+"&key="+s)):($.alert("请选择支付方式"),!1)})}),$(document).on("pageInit","#address",function(e,a,t){var i=$("#address-wrapper");ajax("post","member_address","address_list","",function(e){renderHtml(i,"address",e.datas)}),i.off("click",".address-item").on("click",".address-item",function(){var e=session.get("cartParm");e.address_id=$(this).closest(".card").attr("data-address-id"),e.chain_id="",e.ifchain="",session.set("cartParm",e),$.router.load("#buy","true","true")}),i.off("click","a.edit").on("click","a.edit",function(){var e=$(this).closest(".card").attr("data-address-id");session.set("addressId",e),$.popup(".popup-address-edit")}),i.off("click","a.del").on("click","a.del",function(){var e=$(this).closest(".card"),a=e.attr("data-address-id");$.confirm("确定要删除?",function(){ajax("post","member_address","address_del",{address_id:a},function(a){e.remove();var t=i.find("#address-count"),s=t.text()-0-1;t.text(s)})})}),i.off("click","a.default").on("click","a.default",function(){var e=$(this),a=e.find("i");if(a.hasClass("icon-roundcheckfill"))return!1;var t=e.closest(".card"),s=t.attr("data-address-id");ajax("post","member_address","set_default_address",{address_id:s},function(e){var t=i.find("i.icon-roundcheckfill");t.removeClass("icon-roundcheckfill"),t.addClass("icon-roundcheck"),a.removeClass("icon-roundcheck"),a.addClass("icon-roundcheckfill")},function(){console.log("稍后重试")})}),i.off("click","#add-address").on("click","#add-address",function(){console.log("shouhuodizhi"),session.set("addressId",""),$.popup(".popup-address-edit")})}),$(document).on("pageInit","#account",function(a,t,i){e.revalidate(),ajax("post","member_index","index206","",function(e){var a=e.datas.member_info;if(a.avator&&$("#avator").attr("src",a.avator),$("#nickname").text(a.member_name),a.order_nopay_count>0){var t=$("#nopay_count");t.text(a.order_nopay_count),t.css("display","inline-block")}if(a.order_payed_count>0){var i=$("#payed_count");i.text(a.order_payed_count),i.css("display","inline-block")}if(a.order_noreceipt_count>0){var s=$("#noreceipt_count");s.text(a.order_noreceipt_count),s.css("display","inline-block")}if(a.order_noeval_count>0){var o=$("#noeval_count");o.text(a.order_noeval_count),o.css("display","inline-block")}var n={curpage:1,page:8,order_state:4};$("#orderState").find("a").off("click").click(function(){n.order_state=$(this).attr("data-order-state"),store.set("orderCondition",n)})}),$(".jLogout").off("click").click(function(){var e=[{text:"退出登录",bold:!0,color:"danger",onClick:function(){var e=store.get("token");e.client="wap",ajax("post","logout","",e,function(e){store.set("token",""),$.alert("成功登出"),$.router.load("#home")},function(e){$.alert(e)})}}],a=[{text:"取消"}];$.actions([e,a])})}),$(document).on("pageInit","#order",function(e,a,t){function i(e,a){a&&(e.curpage=1),ajax("post","member_order","order_list206",e,function(t){r=e.curpage,d=t.datas.hasmore,a&&$("#order_wrapper").empty(),t.datas.hasmore&&$.toast("当前"+e.curpage+"页,共"+t.datas.page_total+"页"),s(t.datas)},function(){e.curpage=r})}function s(e){renderHtml($("#order_wrapper"),"my-order",e),$.refreshScroller()}var o=store.get("orderCondition"),n=$(t).find(".buttons-tab a"),r=1,d=!1;n.each(function(){var e=$(this);e.attr("data-order-state")==o.order_state?e.addClass("active"):e.removeClass("active")}),$(n).off("click").click(function(){var e=$(this),a=e.attr("data-order-state");return!e.hasClass("active")&&(e.siblings().removeClass("active"),e.addClass("active"),o.order_state=a,void i(o,!0))}),i(o,!0),$(t).on("infinite",function(){return console.log(3),!!d&&(o.curpage=r+1,void i(o))});var c=$(t).find(".content").on("refresh",function(e){i(o,!0),$.pullToRefreshDone(c)});$(t).off("click",".card-content").on("click",".card-content",function(){session.set("order_id",$(this).data("order_id")),$.router.load("#order_detail")})}),$(document).on("pageInit","#order_detail",function(e,a,t){var i=session.get("order_id");ajax("post","member_order","order_info206",{order_id:i},function(e){renderHtml($(t).find(".content"),"order_detail",e.datas.order_info);var a={order_id:e.datas.order_info.order_id,extend_order_goods:e.datas.order_info.extend_order_goods};session.set("order_item",a)})}),$(document).on("pageInit","#order_evaluate",function(e,a,t){var i=session.get("order_item");console.log(i),renderHtml($(t).find(".content"),"order_evaluate",i),$(t).off("click",".jAnony").on("click",".jAnony",function(){var e=$(this);e.hasClass("icon-roundcheck")?(e.removeClass("icon-roundcheck"),e.addClass("icon-roundcheckfill")):(e.removeClass("icon-roundcheckfill"),e.addClass("icon-roundcheck"))}),$(t).on("click",".icon-start",function(){var e=$(this),a=e.parent(),t=a.data("start"),i=e.data("start");i!=t&&(a.removeClass("starts-"+t),a.addClass("starts-"+i),a.attr("data-start",i))}),$(t).on("click","#evaluate_btn",function(){var e=new Array;$(t).find(".item-inner").each(function(){var a=$(this),t=a.data("rec_id"),i=$(this).find(".item-title").data("start"),s=$(this).find("textarea").val(),o=$(this).find(".jAnony").hasClass("icon-roundcheckfill")?"1":"0";return s?void e.push(t+"|"+i+"|"+s+"|"+o):($.alert("请填写评论内容"),!1)});var a=$(this).data("order_id");ajax("post","member_evaluate","add",{order_id:a,evaluations:e.join()},function(e){$.alert("评价成功"),$.router.back()})})}),$(document).off("click",".jOrderOp").on("click",".jOrderOp",function(){var e=$(this),a=e.parent().data("order_id"),t=e.closest(".card"),i=e.data("optype"),s="";switch(i){case"order_cancel":s="确定要取消?";break;case"order_del":s="确定要删除?";break;case"order_receive":s="确定要收货?"}$.confirm(s,function(){ajax("post","member_order",i,{order_id:a},function(e){t.remove()})})}),$(document).on("click",".jGoPay",function(){var e=$(this);session.set("orderPay",{pay_sn:e.attr("data-pay_sn"),order_total:e.data("order_total")})}),$(document).off("click",".jSearchDeliver").on("click",".jSearchDeliver",function(){session.set("order_sn",$(this).parent().attr("data-order_sn")),$.popup(".popup-deliver")}),$(document).on("pageInit","#favorite",function(a,t,i){function s(a){a&&(o.curpage=1,n.empty()),ajax("post","member_favorites","favorites_list","",function(t){t.hasmore||$(i).find(".more").html(""),a&&t.hasmore&&$(i).find(".more").html('<div class="infinite-scroll-preloader"><div class="preloader"></div></div>'),o.curpage++,r=t.datas.hasmore,renderHtml(n,"favorite",t.datas,!0),e.revalidate()})}$(i).find(".content").on("scroll",function(){e.revalidate()});var o={page:8,curpage:1},n=$("#favorite_list"),r=!1;s(o,!0),$(i).on("infinite",function(){return!!r&&(s(o),void $.refreshScroller())})}),$(document).on("pageInit","#my-comments",function(a,t,i){function s(a){a&&(o.curpage=1,n.empty()),ajax("post","member_evaluate","list","",function(t){t.hasmore||$(i).find(".more").html(""),a&&t.hasmore&&$(i).find(".more").html('<div class="infinite-scroll-preloader"><div class="preloader"></div></div>'),o.curpage++,r=t.datas.hasmore,renderHtml(n,"my_comments",t.datas,!0),e.revalidate()})}$(i).find(".content").on("scroll",function(){e.revalidate()});var o={page:8,curpage:1},n=$("#comments_list"),r=!1;s(o,!0),$(i).on("infinite",function(){return!!r&&(s(o),void $.refreshScroller())})}),$(".jEyes").off("click").click(function(){var e=$(this),a=e.closest(".item-inner").find("input");e.hasClass("icon-attentionforbid")?(e.removeClass("icon-attentionforbid"),e.addClass("icon-attention"),a.attr("type","text")):(e.removeClass("icon-attention"),e.addClass("icon-attentionforbid"),a.attr("type","password"))}),$(".jGetCaptcha").off("click").click(function(){var e=$(this),a=e.data("sms_type"),t=$("#mobile"+a).val();if(!checkMobile(t))return!1;if(e.hasClass("disabled"))return!1;var i=15;e.addClass("disabled");var s=setInterval(function(){i-=1,i>0?e.text(i+"秒后重试"):(e.removeClass("disabled"),e.text("获取验证码"),clearInterval(s))},1e3);$.ajax({url:"http://i.htths.com/index.php?controller=connect_sms&action=get_captcha",type:"POST",data:{phone:t,type:a},dataType:"json",success:function(a){console.log(a),200==a.code?$.alert("验证码已发"):($.toast(a.datas.error),e.removeClass("disabled"),e.text("获取验证码"),clearInterval(s))},error:function(a,t){e.removeClass("disabled"),e.text("获取验证码"),clearInterval(s)}})}),$(document).on("pageInit","#login",function(e,a,t){$("#closeLogin").off("click").click(function(){$.router.load("#home")}),$("#login_btn").off("click").click(function(){var e=$(this),a={username:$("input[name=username]").val(),password:$("input[name=password]").val(),client:"wap"};return a.username?a.password?(e.text("登录中.."),void ajax("post","login","",a,function(a){e.text("登录"),store.set("token",{key:a.datas.key,username:a.datas.username}),$.router.back()},function(){e.text("登录")})):void $.alert("请输入密码"):void $.alert("请输入用户名")}),$("#sign_btn").off("click").click(function(){var e=$("#mobile1").val();if(!checkMobile(e))return!1;var a={phone:e,sms_captcha:$("#captcha_code1").val(),username:$("#username_sign").val(),password:$("#password_sign").val(),client:"wap"};return a.sms_captcha?a.password?void ajax("post","login","sms_register",a,function(e){store.set("token",{key:e.datas.key,username:e.datas.username}),$.router.back()},function(e){$.alert(e)}):($.alert("请输入密码"),!1):($.alert("请输入手机验证码"),!1)})}),$(document).on("pageInit","#setnew_password",function(e,a,t){$("#password_new").off("click").click(function(){var e={old_password:$("#old_password").val(),password:$("#new_password").val()};return e.old_password?e.password?void ajax("post","member_account","modify_pwd",e,function(e){store.set("token",""),$.alert("修改成功,请重新登录"),$.router.back()}):($.alert("请输入新密码"),!1):($.alert("请输入旧的密码"),!1)})}),$(document).on("opened",".popup-find-password",function(){$("#password_reset").off("click").click(function(){var e=$("#mobile3").val();if(!checkMobile(e))return!1;var a={phone:e,sms_captcha:$("#captcha_code3").val(),password:$("#password_find").val()};return a.sms_captcha?a.password?void ajax("post","login","find_password",a,function(e){store.set("token",""),$.closeModal(".popup-find-password"),$.alert("请用新密码进行登录")}):($.alert("请输入密码"),!1):($.alert("请输入手机验证码"),!1)})}),$(document).on("pageInit","#chain",function(e,a,t){$(".item-link").off("click").click(function(){var e=session.get("cartParm");e.chain_id=1,e.ifchain=1,session.set("cartParm",e),$.router.load("#buy","true","true")})}),$(document).on("pageInit","#setting",function(e,a,t){var i=Math.round(encodeURIComponent(JSON.stringify(localStorage)).length/1024),s=i>1024?Math.round(i/1024)+"M":i+"K";$("#cacheSize").text(s),$(t).off("click","#logout").on("click","#logout",function(){var e=[{text:"退出登录",bold:!0,color:"danger",onClick:function(){var e=store.get("token");e.client="wap",ajax("post","logout","",e,function(e){store.set("token",""),$.alert("成功登出")},function(e){$.alert(e)})}}],a=[{text:"取消"}];$.actions([e,a])})}),$(document).on("opened",".popup-address-edit",function(){function e(){var e={address_id:a,pr_id:$("#area1").val(),city_id:$("#area2").val(),area_id:$("#area3").val(),area_info:$("#area-info").text(),address:$("#addr-detail").val(),true_name:$("#true-name").val(),mob_phone:$("#mob-phone").val(),idcard_no:$("#idcard_no").val(),is_default:1,client:"wap"};return e.pr_id&&e.city_id&&e.area_id?e.address?e.true_name?e.mob_phone?(o.text("提交中.."),void ajax("post","member_address","address_addedit",e,function(e){o.text("提交"),$.closeModal(".popup-address-edit");var a="#"+JSON.parse(sessionStorage.getItem("sm.router.currentState")).pageId;$.router.load(a,"true","true")},function(e){o.text("提交")})):void $.alert("请输入手机号"):void $.alert("请输入收货人姓名"):void $.alert("请输入收货地址"):void $.alert("请选择区域")}var a=session.get("addressId"),t=$("#addr-edit-wrapper");if(console.log(a),a>0)ajax("post","member_address","address_info",{address_id:a},function(e){renderHtml(t,"addr-edit",e.datas)},function(e){o.text("提交")});else{var i={address_info:{address:"",address_id:"",area_id:"",area_info:"",bpic:"",city_id:"",dlyp_id:"",fpic:"",idcard_back:"",idcard_front:"",idcard_no:"",is_default:"",member_id:"",mob_phone:"",pr_id:"",tel_phone:"",true_name:""}},s=store.get("area");s&&(i.address_info.pr_id=s.area1,i.address_info.city_id=s.area2,i.address_info.area_id=s.area3,i.address_info.area_info=s.areainfo),renderHtml(t,"addr-edit",i)}var o=$("#addr-submit");o.off("click").click(function(){e()})}),$(document).on("opened",".popup-area",function(){function e(e){var t="undefined"==typeof e?0:e;t="area"+t;var i=store.get(t);if(i){var s=template("area",i);return a.html(s),!1}ajax("get","area","area_list",{area_id:e},function(e){var i=e.datas;store.set(t,i),renderHtml(a,"area",i)})}var a=$("#area-wrapper"),t={},i="";e(),a.off("click","li").on("click","li",function(){var a=$(this),s=a.attr("data-area-id"),o=a.attr("data-area-deep"),n=a.attr("data-area-name");t["area"+o]=s,i+=n,o<3?e(s):($.closeModal(".popup-area"),$("#area1").val(t.area1),$("#area2").val(t.area2),$("#area3").val(t.area3),$("#area-info").text(i),t.areainfo=i,store.set("area",t))})}),$(document).on("opened",".popup-deliver",function(){var e=session.get("order_sn");ajax("post","member_order","search_deliver",{order_sn:e},function(e){renderHtml($("#deliver_wrapper"),"deliver",e.datas)})}),$.init()});